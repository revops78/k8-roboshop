apiVersion: v1
kind: ConfigMap
metadata:
  name: catalogue
data:
  MONGO: "true" 
  MONGO_URL: "mongodb://mongodb:27017/catalogue"
---

apiVersion: apps/v1
kind: Deployment
metadata:
  name: catalogue
  namespace: roboshop
  labels:
    component: catalogue
    project : roboshop
    tier : database
spec:
  replicas: 1   # Number of pod replicas
  selector:
    matchLabels:
      component: catalogue
      project : roboshop
      tier : database
  template:
    metadata:
      labels:
        component: catalogue
        project : roboshop
        tier : database
    spec:
      containers:
        - name: catalogue
          image: revops78/catalogue:v1
          envFrom:
            - configMapRef:
                name: catalogue
---
apiVersion: v1
kind: Service
metadata:
  name: catalogue
  namespace: roboshop
  labels:
    component: catalogue
    project : roboshop
    tier : app
spec:
  selector:
    component: catalogue
    project : roboshop
    tier : database  
  ports:
    - protocol: TCP
      port: 8080
      targetPort: 8080
          


